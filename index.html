<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>window.bitrune API 文档</title>
  <script src="libs.js"></script>
  <script src="bitrune.js"></script>
  <style>
    body {
      font-family: sans-serif;
      line-height: 1.618;
      max-width: 800px;
      margin: 0 auto;
      padding: 1.618rem;
    }

    pre {
      background-color: #f4f4f4;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: .618rem;
      overflow-x: auto;
      white-space: pre-wrap;
      word-break: break-all;
    }

    pre,
    code {
      font-family: Consolas, monospace;
      font-size: 13px;
      outline: none;
    }

    pre code {
      display: block;
    }

    button {
      background-color: #f7931a;
      color: white;
      border: none;
      padding: 0 1.309em;
      cursor: pointer;
      border-radius: 4px;
      height: 2.618em;
      font-size: 1rem;
    }

    button:active {
      background-color: #995b10;
    }
  </style>
</head>

<body>
  <h1>bitrune API 文档</h1>

  <h2>导入</h2>
  <a href="libs.js">libs.js</a> + <a href="bitrune.js">bitrune.js</a>
  <pre><code>&lt;script src="libs.js"&gt;&lt;/script&gt;
&lt;script src="bitrune.js"&gt;&lt;/script&gt;</code></pre>

  <h2>1. connect 方法</h2>
  <p>用于连接钱包并获取用户信息。</p>
  <h3>参数：</h3>
  <ul>
    <li><code>isTestnet</code>：布尔值，表示是否使用测试网。</li>
  </ul>
  <h3>返回值：</h3>
  <p>Promise，解析为包含以下属性的对象：</p>
  <ul>
    <li><code>walletType</code>：字符串，钱包类型（"unisat" 或 "okx"）</li>
    <li><code>network</code>：字符串，网络类型（"testnet" 或 "livenet"）</li>
    <li><code>address</code>：字符串，用户的比特币地址</li>
    <li><code>publicKey</code>：字符串，用户的公钥</li>
    <li><code>balance</code>：数字，用户的 BTC 余额（单位：聪）</li>
  </ul>
  <h3>示例：</h3>
  <pre><code contenteditable="true" id="code_connect">const isTestnet = true

bitrune.connect(isTestnet).then(result => {
  document.getElementById('connectResult').textContent = JSON.stringify(result, null, 2)
}).catch(err => {
  document.getElementById('connectResult').textContent = '连接失败: ' + err.message
})</code></pre>
  <button onclick="connectWallet()">连接钱包</button>
  <pre id="connectResult"></pre>

  <h2>2. sendRunesMany 方法</h2>
  <p>用于发送多个 Rune 交易（需要先连接钱包）。</p>
  <h3>参数：</h3>
  <ul>
    <li><code>isTestnet</code>：布尔值，表示是否使用测试网。</li>
    <li><code>runeId</code>：字符串，Rune 的 ID。</li>
    <li><code>outputs</code>：数组，包含多个输出对象，每个对象包含：
      <ul>
        <li><code>toAddress</code>：字符串，接收地址</li>
        <li><code>amount</code>：数字，发送数量</li>
      </ul>
    </li>
    <li><code>options</code>：可选对象，包含：
      <ul>
        <li><code>feeRate</code>：数字，自定义手续费率（单位：聪/字节）</li>
      </ul>
    </li>
  </ul>
  <h3>返回值：</h3>
  <p>Promise，解析为签名后的 PSBT 十六进制字符串。</p>
  <h3>示例：</h3>
  <pre><code contenteditable="true" id="code_sendrunes_many">const isTestnet = true

const outputs = [
  { toAddress: 'tb1q47tzthnmft9l62k23w33jrd2gya8vnml389kz7', amount: 12300000000 },
  { toAddress: 'tb1pe8dvq8an9ueaeruqax6ql78hgh9gdd3nfq3rvv6wampar4tnx9pq2e5y20', amount: 45600000000 }
]

bitrune.sendRunesMany({
  isTestnet,
  runeId: isTestnet ? '2871448:97' : '853995:330',
  outputs,
  options: { feeRate: 5 }
}).then(signedPSBTHex => {
  document.getElementById('sendResult').textContent = '交易已签名: ' + signedPSBTHex
}).catch(err => {
  document.getElementById('sendResult').textContent = '发送失败: ' + err.message
})</code></pre>
  <button onclick="sendRunes()">发送 Runes</button>
  <pre id="sendResult"></pre>

  <script>
    function connectWallet() {
      try {
        new Function(document.getElementById('code_connect').textContent)()
      } catch (err) {
        alert(err.message)
      }
    }

    function sendRunes() {
      try {
        new Function(document.getElementById('code_sendrunes_many').textContent)()
      } catch (err) {
        alert(err.message)
      }
    }
  </script>
</body>

</html>